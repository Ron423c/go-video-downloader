// Code generated by transpiler. DO NOT EDIT.

/**
 * Go Video Downloader
 *
 *    Copyright 2019 Tenta, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * For any questions, please contact developer@tenta.io
 *
 * jamendo/module.go: transpiled from https://github.com/ytdl-org/youtube-dl/blob/master/youtube_dl/extractor/jamendo.py
 */

package jamendo

import (
	Ωcompat "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/compat"
	Ωcommon "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/extractor/common"
	Ωutils "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/utils"
	λ "github.com/tenta-browser/go-video-downloader/runtime"
)

var (
	InfoExtractor  λ.Object
	JamendoAlbumIE λ.Object
	JamendoIE      λ.Object
	ϒclean_html    λ.Object
	ϒcompat_str    λ.Object
	ϒint_or_none   λ.Object
	ϒtry_get       λ.Object
)

func init() {
	λ.InitModule(func() {
		ϒcompat_str = Ωcompat.ϒcompat_str
		InfoExtractor = Ωcommon.InfoExtractor
		ϒclean_html = Ωutils.ϒclean_html
		ϒint_or_none = Ωutils.ϒint_or_none
		ϒtry_get = Ωutils.ϒtry_get
		JamendoIE = λ.Cal(λ.TypeType, λ.NewStr("JamendoIE"), λ.NewTuple(InfoExtractor), func() λ.Dict {
			var (
				JamendoIE__TESTS        λ.Object
				JamendoIE__VALID_URL    λ.Object
				JamendoIE__real_extract λ.Object
			)
			JamendoIE__VALID_URL = λ.NewStr("(?x)\n                    https?://\n                        (?:\n                            licensing\\.jamendo\\.com/[^/]+|\n                            (?:www\\.)?jamendo\\.com\n                        )\n                        /track/(?P<id>[0-9]+)(?:/(?P<display_id>[^/?#&]+))?\n                    ")
			JamendoIE__TESTS = λ.NewList(
				λ.NewDictWithTable(map[λ.Object]λ.Object{
					λ.NewStr("url"): λ.NewStr("https://www.jamendo.com/track/196219/stories-from-emona-i"),
					λ.NewStr("md5"): λ.NewStr("6e9e82ed6db98678f171c25a8ed09ffd"),
					λ.NewStr("info_dict"): λ.NewDictWithTable(map[λ.Object]λ.Object{
						λ.NewStr("id"):          λ.NewStr("196219"),
						λ.NewStr("display_id"):  λ.NewStr("stories-from-emona-i"),
						λ.NewStr("ext"):         λ.NewStr("flac"),
						λ.NewStr("title"):       λ.NewStr("Maya Filipič - Stories from Emona I"),
						λ.NewStr("artist"):      λ.NewStr("Maya Filipič"),
						λ.NewStr("track"):       λ.NewStr("Stories from Emona I"),
						λ.NewStr("duration"):    λ.NewInt(210),
						λ.NewStr("thumbnail"):   λ.NewStr("re:^https?://.*\\.jpg"),
						λ.NewStr("timestamp"):   λ.NewInt(1217438117),
						λ.NewStr("upload_date"): λ.NewStr("20080730"),
					}),
				}),
				λ.NewDictWithTable(map[λ.Object]λ.Object{
					λ.NewStr("url"):           λ.NewStr("https://licensing.jamendo.com/en/track/1496667/energetic-rock"),
					λ.NewStr("only_matching"): λ.True,
				}),
			)
			JamendoIE__real_extract = λ.NewFunction("_real_extract",
				[]λ.Param{
					{Name: "self"},
					{Name: "url"},
				},
				0, false, false,
				func(λargs []λ.Object) λ.Object {
					var (
						ϒalbum       λ.Object
						ϒartist      λ.Object
						ϒartist_name λ.Object
						ϒcover_id    λ.Object
						ϒcover_url   λ.Object
						ϒcovers      λ.Object
						ϒdisplay_id  λ.Object
						ϒformats     λ.Object
						ϒget_model   λ.Object
						ϒmodels      λ.Object
						ϒself        = λargs[0]
						ϒsize        λ.Object
						ϒstats       λ.Object
						ϒtag         λ.Object
						ϒtag_name    λ.Object
						ϒtags        λ.Object
						ϒthumbnails  λ.Object
						ϒtitle       λ.Object
						ϒtrack       λ.Object
						ϒtrack_id    λ.Object
						ϒtrack_name  λ.Object
						ϒurl         = λargs[1]
						ϒurls        λ.Object
						ϒwebpage     λ.Object
						τmp0         λ.Object
						τmp1         λ.Object
						τmp2         λ.Object
						τmp3         λ.Object
						τmp4         λ.Object
					)
					τmp0 = λ.Cal(λ.GetAttr(λ.Cal(λ.GetAttr(λ.GetAttr(ϒself, "_VALID_URL_RE", nil), "match", nil), ϒurl), "groups", nil))
					ϒtrack_id = λ.GetItem(τmp0, λ.NewInt(0))
					ϒdisplay_id = λ.GetItem(τmp0, λ.NewInt(1))
					ϒwebpage = λ.Cal(λ.GetAttr(ϒself, "_download_webpage", nil), λ.Add(λ.NewStr("https://www.jamendo.com/track/"), ϒtrack_id), ϒtrack_id)
					ϒmodels = λ.Cal(λ.GetAttr(ϒself, "_parse_json", nil), λ.Cal(λ.GetAttr(ϒself, "_html_search_regex", nil), λ.NewStr("data-bundled-models='([^']+)"), ϒwebpage, λ.NewStr("bundled models")), ϒtrack_id)
					ϒtrack = λ.GetItem(λ.GetItem(λ.GetItem(ϒmodels, λ.NewStr("track")), λ.NewStr("models")), λ.NewInt(0))
					τmp0 = λ.GetItem(ϒtrack, λ.NewStr("name"))
					ϒtitle = τmp0
					ϒtrack_name = τmp0
					ϒget_model = λ.NewFunction("<lambda>",
						[]λ.Param{
							{Name: "x"},
						},
						0, false, false,
						func(λargs []λ.Object) λ.Object {
							var (
								ϒx = λargs[0]
							)
							return func() λ.Object {
								if λv := λ.Cal(ϒtry_get, ϒmodels, λ.NewFunction("<lambda>",
									[]λ.Param{
										{Name: "y"},
									},
									0, false, false,
									func(λargs []λ.Object) λ.Object {
										var (
											ϒy = λargs[0]
										)
										return λ.GetItem(λ.GetItem(λ.GetItem(ϒy, ϒx), λ.NewStr("models")), λ.NewInt(0))
									}), λ.DictType); λ.IsTrue(λv) {
									return λv
								} else {
									return λ.NewDictWithTable(map[λ.Object]λ.Object{})
								}
							}()
						})
					ϒartist = λ.Cal(ϒget_model, λ.NewStr("artist"))
					ϒartist_name = λ.Cal(λ.GetAttr(ϒartist, "get", nil), λ.NewStr("name"))
					if λ.IsTrue(ϒartist_name) {
						ϒtitle = λ.Mod(λ.NewStr("%s - %s"), λ.NewTuple(
							ϒartist_name,
							ϒtitle,
						))
					}
					ϒalbum = λ.Cal(ϒget_model, λ.NewStr("album"))
					ϒformats = λ.Cal(λ.ListType, λ.Cal(λ.NewFunction("<generator>",
						nil,
						0, false, false,
						func(λargs []λ.Object) λ.Object {
							return λ.NewGenerator(func(λgy λ.Yielder) λ.Object {
								var (
									ϒext        λ.Object
									ϒformat_id  λ.Object
									ϒquality    λ.Object
									ϒsub_domain λ.Object
									τmp0        λ.Object
									τmp1        λ.Object
									τmp2        λ.Object
									τmp3        λ.Object
								)
								τmp0 = λ.Cal(λ.BuiltinIter, λ.Cal(λ.EnumerateIteratorType, λ.NewTuple(
									λ.NewTuple(
										λ.NewStr("mp31"),
										λ.NewStr("mp3l"),
										λ.NewStr("mp3"),
									),
									λ.NewTuple(
										λ.NewStr("mp32"),
										λ.NewStr("mp3d"),
										λ.NewStr("mp3"),
									),
									λ.NewTuple(
										λ.NewStr("ogg1"),
										λ.NewStr("ogg"),
										λ.NewStr("ogg"),
									),
									λ.NewTuple(
										λ.NewStr("flac"),
										λ.NewStr("flac"),
										λ.NewStr("flac"),
									),
								)))
								for {
									if τmp1 = λ.NextDefault(τmp0, λ.AfterLast); τmp1 == λ.AfterLast {
										break
									}
									τmp2 = τmp1
									ϒquality = λ.GetItem(τmp2, λ.NewInt(0))
									τmp3 = λ.GetItem(τmp2, λ.NewInt(1))
									ϒformat_id = λ.GetItem(τmp3, λ.NewInt(0))
									ϒsub_domain = λ.GetItem(τmp3, λ.NewInt(1))
									ϒext = λ.GetItem(τmp3, λ.NewInt(2))
									λgy.Yield(λ.NewDictWithTable(map[λ.Object]λ.Object{
										λ.NewStr("url"): λ.Mod(λ.NewStr("https://%s.jamendo.com/?trackid=%s&format=%s&from=app-97dab294"), λ.NewTuple(
											ϒsub_domain,
											ϒtrack_id,
											ϒformat_id,
										)),
										λ.NewStr("format_id"): ϒformat_id,
										λ.NewStr("ext"):       ϒext,
										λ.NewStr("quality"):   ϒquality,
									}))
								}
								return λ.None
							})
						})))
					λ.Cal(λ.GetAttr(ϒself, "_sort_formats", nil), ϒformats)
					ϒurls = λ.NewList()
					ϒthumbnails = λ.NewList()
					τmp0 = λ.Cal(λ.BuiltinIter, λ.Cal(λ.GetAttr(λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("cover"), λ.NewDictWithTable(map[λ.Object]λ.Object{})), "items", nil)))
					for {
						if τmp1 = λ.NextDefault(τmp0, λ.AfterLast); τmp1 == λ.AfterLast {
							break
						}
						τmp2 = τmp1
						_ = λ.GetItem(τmp2, λ.NewInt(0))
						ϒcovers = λ.GetItem(τmp2, λ.NewInt(1))
						τmp2 = λ.Cal(λ.BuiltinIter, λ.Cal(λ.GetAttr(ϒcovers, "items", nil)))
						for {
							if τmp3 = λ.NextDefault(τmp2, λ.AfterLast); τmp3 == λ.AfterLast {
								break
							}
							τmp4 = τmp3
							ϒcover_id = λ.GetItem(τmp4, λ.NewInt(0))
							ϒcover_url = λ.GetItem(τmp4, λ.NewInt(1))
							if λ.IsTrue(func() λ.Object {
								if λv := λ.NewBool(!λ.IsTrue(ϒcover_url)); λ.IsTrue(λv) {
									return λv
								} else {
									return λ.NewBool(λ.Contains(ϒurls, ϒcover_url))
								}
							}()) {
								continue
							}
							λ.Cal(λ.GetAttr(ϒurls, "append", nil), ϒcover_url)
							ϒsize = λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒcover_id, "lstrip", nil), λ.NewStr("size")))
							λ.Cal(λ.GetAttr(ϒthumbnails, "append", nil), λ.NewDictWithTable(map[λ.Object]λ.Object{
								λ.NewStr("id"):     ϒcover_id,
								λ.NewStr("url"):    ϒcover_url,
								λ.NewStr("width"):  ϒsize,
								λ.NewStr("height"): ϒsize,
							}))
						}
					}
					ϒtags = λ.NewList()
					τmp0 = λ.Cal(λ.BuiltinIter, λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("tags"), λ.NewList()))
					for {
						if τmp1 = λ.NextDefault(τmp0, λ.AfterLast); τmp1 == λ.AfterLast {
							break
						}
						ϒtag = τmp1
						ϒtag_name = λ.Cal(λ.GetAttr(ϒtag, "get", nil), λ.NewStr("name"))
						if λ.IsTrue(λ.NewBool(!λ.IsTrue(ϒtag_name))) {
							continue
						}
						λ.Cal(λ.GetAttr(ϒtags, "append", nil), ϒtag_name)
					}
					ϒstats = func() λ.Object {
						if λv := λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("stats")); λ.IsTrue(λv) {
							return λv
						} else {
							return λ.NewDictWithTable(map[λ.Object]λ.Object{})
						}
					}()
					return λ.NewDictWithTable(map[λ.Object]λ.Object{
						λ.NewStr("id"):          ϒtrack_id,
						λ.NewStr("display_id"):  ϒdisplay_id,
						λ.NewStr("thumbnails"):  ϒthumbnails,
						λ.NewStr("title"):       ϒtitle,
						λ.NewStr("description"): λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("description")),
						λ.NewStr("duration"):    λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("duration"))),
						λ.NewStr("artist"):      ϒartist_name,
						λ.NewStr("track"):       ϒtrack_name,
						λ.NewStr("album"):       λ.Cal(λ.GetAttr(ϒalbum, "get", nil), λ.NewStr("name")),
						λ.NewStr("formats"):     ϒformats,
						λ.NewStr("license"): func() λ.Object {
							if λv := λ.Cal(λ.GetAttr(λ.NewStr("-"), "join", nil), λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("licenseCC"), λ.NewList())); λ.IsTrue(λv) {
								return λv
							} else {
								return λ.None
							}
						}(),
						λ.NewStr("timestamp"):      λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒtrack, "get", nil), λ.NewStr("dateCreated"))),
						λ.NewStr("view_count"):     λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒstats, "get", nil), λ.NewStr("listenedAll"))),
						λ.NewStr("like_count"):     λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒstats, "get", nil), λ.NewStr("favorited"))),
						λ.NewStr("average_rating"): λ.Cal(ϒint_or_none, λ.Cal(λ.GetAttr(ϒstats, "get", nil), λ.NewStr("averageNote"))),
						λ.NewStr("tags"):           ϒtags,
					})
				})
			return λ.NewDictWithTable(map[λ.Object]λ.Object{
				λ.NewStr("_TESTS"):        JamendoIE__TESTS,
				λ.NewStr("_VALID_URL"):    JamendoIE__VALID_URL,
				λ.NewStr("_real_extract"): JamendoIE__real_extract,
			})
		}())
		JamendoAlbumIE = λ.Cal(λ.TypeType, λ.NewStr("JamendoAlbumIE"), λ.NewTuple(InfoExtractor), func() λ.Dict {
			var (
				JamendoAlbumIE__VALID_URL λ.Object
			)
			JamendoAlbumIE__VALID_URL = λ.NewStr("https?://(?:www\\.)?jamendo\\.com/album/(?P<id>[0-9]+)")
			return λ.NewDictWithTable(map[λ.Object]λ.Object{
				λ.NewStr("_VALID_URL"): JamendoAlbumIE__VALID_URL,
			})
		}())
	})
}
